<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Editor</title>
</head>
<body style="background: green; color: #f00">
<div id="editor"></div>
<div id="table" contenteditable="true"><pre lang="Typescript"><span class="tb-hl-keyword">import</span>&nbsp;<span class="tb-hl-punctuation">{</span>&nbsp;EventEmitter&nbsp;<span class="tb-hl-punctuation">}</span>&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'./events'</span><span class="tb-hl-punctuation">;</span><br><br><span class="tb-hl-comment">/**<br>&nbsp;* 虚拟 DOM 节点的字面量表示。<br>&nbsp;*/</span><br><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">VElementLiteral</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;tagName<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;styles<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-punctuation">{</span>&nbsp;<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">]</span><span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">any</span>&nbsp;<span class="tb-hl-punctuation">},</span><br>&nbsp;&nbsp;attrs<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-punctuation">{</span>&nbsp;<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">]</span><span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">any</span>&nbsp;<span class="tb-hl-punctuation">},</span><br>&nbsp;&nbsp;classes<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">[];</span><br>&nbsp;&nbsp;childNodes<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">Array</span><span class="tb-hl-operator">&lt;</span>VElementLiteral&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">;</span><br><span class="tb-hl-punctuation">}</span><br><br><span class="tb-hl-comment">/**<br>&nbsp;* 虚拟文本节点。<br>&nbsp;*/</span><br><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">class</span>&nbsp;<span class="tb-hl-class-name">VTextNode</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;<span class="tb-hl-keyword">constructor</span><span class="tb-hl-punctuation">(</span><span class="tb-hl-keyword">public</span>&nbsp;<span class="tb-hl-keyword">readonly</span>&nbsp;textContent<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-string">''</span><span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><span class="tb-hl-punctuation">}</span><br><br><span class="tb-hl-comment">/**<br>&nbsp;* 配置虚拟 DOM 节点的属性选项。<br>&nbsp;*/</span><br><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">VElementOption</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;attrs<span class="tb-hl-operator">?:</span>&nbsp;<span class="tb-hl-punctuation">{</span>&nbsp;<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">]</span><span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">boolean</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">number</span>&nbsp;<span class="tb-hl-punctuation">};</span><br>&nbsp;&nbsp;styles<span class="tb-hl-operator">?:</span>&nbsp;<span class="tb-hl-punctuation">{</span>&nbsp;<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">]</span><span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">number</span>&nbsp;<span class="tb-hl-punctuation">};</span><br>&nbsp;&nbsp;classes<span class="tb-hl-operator">?:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">[];</span><br>&nbsp;&nbsp;childNodes<span class="tb-hl-operator">?:</span>&nbsp;<span class="tb-hl-builtin">Array</span><span class="tb-hl-operator">&lt;</span>VElement&nbsp;<span class="tb-hl-operator">|</span>&nbsp;VTextNode<span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">;</span><br><span class="tb-hl-punctuation">}</span><br><br><span class="tb-hl-comment">/**<br>&nbsp;* 虚拟 DOM 节点<br>&nbsp;*/</span><br><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">class</span>&nbsp;<span class="tb-hl-class-name">VElement</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;<span class="tb-hl-keyword">readonly</span>&nbsp;events&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">EventEmitter</span><span class="tb-hl-punctuation">();</span><br>&nbsp;&nbsp;<span class="tb-hl-keyword">readonly</span>&nbsp;childNodes<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">Array</span><span class="tb-hl-operator">&lt;</span>VElement&nbsp;<span class="tb-hl-operator">|</span>&nbsp;VTextNode<span class="tb-hl-operator">&gt;</span>&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-punctuation">[];</span><br>&nbsp;&nbsp;<span class="tb-hl-keyword">readonly</span>&nbsp;attrs&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Map</span><span class="tb-hl-operator">&lt;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">,</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-operator">|</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-builtin">number</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-operator">|</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-builtin">boolean</span><span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">();</span><br>&nbsp;&nbsp;<span class="tb-hl-keyword">readonly</span>&nbsp;styles&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Map</span><span class="tb-hl-operator">&lt;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">,</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-operator">|</span><span class="tb-hl-class-name">&nbsp;</span><span class="tb-hl-builtin">number</span><span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">();</span><br>&nbsp;&nbsp;<span class="tb-hl-keyword">readonly</span>&nbsp;classes<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">[]</span>&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-punctuation">[];</span><br><br>&nbsp;&nbsp;<span class="tb-hl-keyword">constructor</span><span class="tb-hl-punctuation">(</span><span class="tb-hl-keyword">public</span>&nbsp;tagName<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">,</span>&nbsp;options<span class="tb-hl-operator">?:</span>&nbsp;VElementOption<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">keys</span><span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">).</span><span class="tb-hl-function">forEach</span><span class="tb-hl-punctuation">(</span>key&nbsp;<span class="tb-hl-operator">=&gt;</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">.</span><span class="tb-hl-keyword">set</span><span class="tb-hl-punctuation">(</span>key<span class="tb-hl-punctuation">,</span>&nbsp;options<span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-punctuation">]));</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">keys</span><span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">).</span><span class="tb-hl-function">forEach</span><span class="tb-hl-punctuation">(</span>key&nbsp;<span class="tb-hl-operator">=&gt;</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">.</span><span class="tb-hl-keyword">set</span><span class="tb-hl-punctuation">(</span>key<span class="tb-hl-punctuation">,</span>&nbsp;options<span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-punctuation">]));</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">.</span>classes<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>classes<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">push</span><span class="tb-hl-punctuation">(</span><span class="tb-hl-operator">...</span>options<span class="tb-hl-punctuation">.</span>classes<span class="tb-hl-punctuation">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>options<span class="tb-hl-punctuation">.</span>childNodes<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>childNodes<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">push</span><span class="tb-hl-punctuation">(</span><span class="tb-hl-operator">...</span>options<span class="tb-hl-punctuation">.</span>childNodes<span class="tb-hl-punctuation">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;<span class="tb-hl-comment">/**<br>&nbsp;&nbsp;&nbsp;* 在最后位置添加一个子节点。<br>&nbsp;&nbsp;&nbsp;* @param newChild<br>&nbsp;&nbsp;&nbsp;*/</span><br>&nbsp;&nbsp;<span class="tb-hl-function">appendChild</span><span class="tb-hl-punctuation">(</span>newChild<span class="tb-hl-operator">:</span>&nbsp;VElement&nbsp;<span class="tb-hl-operator">|</span>&nbsp;VTextNode<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>childNodes<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">push</span><span class="tb-hl-punctuation">(</span>newChild<span class="tb-hl-punctuation">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;newChild<span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;<span class="tb-hl-comment">/**<br>&nbsp;&nbsp;&nbsp;* 判断一个虚拟 DOM 节点是否和自己相等。<br>&nbsp;&nbsp;&nbsp;* @param vElement<br>&nbsp;&nbsp;&nbsp;*/</span><br>&nbsp;&nbsp;<span class="tb-hl-function">equal</span><span class="tb-hl-punctuation">(</span>vElement<span class="tb-hl-operator">:</span>&nbsp;VElement<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>vElement&nbsp;<span class="tb-hl-operator">===</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">true</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span><span class="tb-hl-operator">!</span>vElement<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">false</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;left&nbsp;<span class="tb-hl-operator">=</span>&nbsp;vElement<span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;right&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;left<span class="tb-hl-punctuation">.</span>tagName&nbsp;<span class="tb-hl-operator">==</span>&nbsp;right<span class="tb-hl-punctuation">.</span>tagName&nbsp;<span class="tb-hl-operator">&amp;&amp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VElement<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">equalMap</span><span class="tb-hl-punctuation">(</span>left<span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">,</span>&nbsp;right<span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-operator">&amp;&amp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VElement<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">equalMap</span><span class="tb-hl-punctuation">(</span>left<span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">,</span>&nbsp;right<span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-operator">&amp;&amp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VElement<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">equalClasses</span><span class="tb-hl-punctuation">(</span>left<span class="tb-hl-punctuation">.</span>classes<span class="tb-hl-punctuation">,</span>&nbsp;right<span class="tb-hl-punctuation">.</span>classes<span class="tb-hl-punctuation">);</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;<span class="tb-hl-comment">/**<br>&nbsp;&nbsp;&nbsp;* 把当前虚拟 DOM 节点转换为 JSON 字面量。<br>&nbsp;&nbsp;&nbsp;*/</span><br>&nbsp;&nbsp;<span class="tb-hl-function">toJSON</span><span class="tb-hl-punctuation">()</span><span class="tb-hl-operator">:</span>&nbsp;VElementLiteral&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagName<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>tagName<span class="tb-hl-punctuation">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;styles<span class="tb-hl-operator">:</span>&nbsp;VElement<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">mapToJSON</span><span class="tb-hl-punctuation">(</span><span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>styles<span class="tb-hl-punctuation">),</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attrs<span class="tb-hl-operator">:</span>&nbsp;VElement<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">mapToJSON</span><span class="tb-hl-punctuation">(</span><span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>attrs<span class="tb-hl-punctuation">),</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;classes<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>classes<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">map</span><span class="tb-hl-punctuation">(</span>i&nbsp;<span class="tb-hl-operator">=&gt;</span>&nbsp;i<span class="tb-hl-punctuation">),</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;childNodes<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-keyword">this</span><span class="tb-hl-punctuation">.</span>childNodes<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">map</span><span class="tb-hl-punctuation">(</span>c&nbsp;<span class="tb-hl-operator">=&gt;</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>c&nbsp;<span class="tb-hl-keyword">instanceof</span>&nbsp;<span class="tb-hl-class-name">VElement</span><span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;c<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">toJSON</span><span class="tb-hl-punctuation">();</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;c<span class="tb-hl-punctuation">.</span>textContent<span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">})</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;<span class="tb-hl-keyword">private</span>&nbsp;<span class="tb-hl-keyword">static</span>&nbsp;<span class="tb-hl-function">mapToJSON</span><span class="tb-hl-punctuation">(</span>map<span class="tb-hl-operator">:</span>&nbsp;Map<span class="tb-hl-operator">&lt;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">,</span>&nbsp;<span class="tb-hl-builtin">any</span><span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;obj&nbsp;<span class="tb-hl-operator">=</span>&nbsp;<span class="tb-hl-punctuation">{};</span><br>&nbsp;&nbsp;&nbsp;&nbsp;map<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">forEach</span><span class="tb-hl-punctuation">((</span>value<span class="tb-hl-punctuation">,</span>&nbsp;key<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-operator">=&gt;</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj<span class="tb-hl-punctuation">[</span>key<span class="tb-hl-punctuation">]</span>&nbsp;<span class="tb-hl-operator">=</span>&nbsp;value<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">});</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;obj<span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;<span class="tb-hl-keyword">private</span>&nbsp;<span class="tb-hl-keyword">static</span>&nbsp;<span class="tb-hl-function">equalMap</span><span class="tb-hl-punctuation">(</span>left<span class="tb-hl-operator">:</span>&nbsp;Map<span class="tb-hl-operator">&lt;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">,</span>&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">number</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">boolean</span><span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">,</span>&nbsp;right<span class="tb-hl-operator">:</span>&nbsp;Map<span class="tb-hl-operator">&lt;</span><span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">,</span>&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">number</span>&nbsp;<span class="tb-hl-operator">|</span>&nbsp;<span class="tb-hl-builtin">boolean</span><span class="tb-hl-operator">&gt;</span><span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>left&nbsp;<span class="tb-hl-operator">===</span>&nbsp;right&nbsp;<span class="tb-hl-operator">||</span>&nbsp;<span class="tb-hl-operator">!</span>left&nbsp;<span class="tb-hl-operator">===</span>&nbsp;<span class="tb-hl-boolean">true</span>&nbsp;<span class="tb-hl-operator">&amp;&amp;</span>&nbsp;<span class="tb-hl-operator">!</span>right&nbsp;<span class="tb-hl-operator">===</span>&nbsp;<span class="tb-hl-boolean">true</span><span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">true</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span><span class="tb-hl-operator">!</span>left&nbsp;<span class="tb-hl-operator">!==</span>&nbsp;<span class="tb-hl-operator">!</span>right&nbsp;<span class="tb-hl-operator">||</span>&nbsp;left<span class="tb-hl-punctuation">.</span>size&nbsp;<span class="tb-hl-operator">!==</span>&nbsp;right<span class="tb-hl-punctuation">.</span>size<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">false</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-builtin">Array</span><span class="tb-hl-punctuation">.</span><span class="tb-hl-keyword">from</span><span class="tb-hl-punctuation">(</span>left<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">keys</span><span class="tb-hl-punctuation">()).</span><span class="tb-hl-function">reduce</span><span class="tb-hl-punctuation">((</span>v<span class="tb-hl-punctuation">,</span>&nbsp;key<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-operator">=&gt;</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;v&nbsp;<span class="tb-hl-operator">&amp;&amp;</span>&nbsp;left<span class="tb-hl-punctuation">.</span><span class="tb-hl-keyword">get</span><span class="tb-hl-punctuation">(</span>key<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-operator">===</span>&nbsp;right<span class="tb-hl-punctuation">.</span><span class="tb-hl-keyword">get</span><span class="tb-hl-punctuation">(</span>key<span class="tb-hl-punctuation">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">},</span>&nbsp;<span class="tb-hl-boolean">true</span><span class="tb-hl-punctuation">);</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;<span class="tb-hl-keyword">private</span>&nbsp;<span class="tb-hl-keyword">static</span>&nbsp;<span class="tb-hl-function">equalClasses</span><span class="tb-hl-punctuation">(</span>left<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">[],</span>&nbsp;right<span class="tb-hl-operator">:</span>&nbsp;<span class="tb-hl-builtin">string</span><span class="tb-hl-punctuation">[])</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>left&nbsp;<span class="tb-hl-operator">===</span>&nbsp;right<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">true</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span>left<span class="tb-hl-punctuation">.</span>length&nbsp;<span class="tb-hl-operator">!==</span>&nbsp;right<span class="tb-hl-punctuation">.</span>length<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">false</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">for</span>&nbsp;<span class="tb-hl-punctuation">(</span><span class="tb-hl-keyword">const</span>&nbsp;k&nbsp;<span class="tb-hl-keyword">of</span>&nbsp;left<span class="tb-hl-punctuation">)</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;<span class="tb-hl-punctuation">(</span><span class="tb-hl-operator">!</span>right<span class="tb-hl-punctuation">.</span><span class="tb-hl-function">includes</span><span class="tb-hl-punctuation">(</span>k<span class="tb-hl-punctuation">))</span>&nbsp;<span class="tb-hl-punctuation">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">false</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-boolean">true</span><span class="tb-hl-punctuation">;</span><br>&nbsp;&nbsp;<span class="tb-hl-punctuation">}</span><br><span class="tb-hl-punctuation">}</span><br><br></pre><p><br></p>
</div>
<p>
  <button type="button" id="btn">destroy</button>
</p>
</body>
</html>

